{
  "id": "meet_start_performing_task",
  "formKey": "",
  "title": {
    "en": "Meeting Start Performing Task"
  },
  "description": {},
  "customModule": null,
  "typeRef": "",
  "width": "lg",
  "i18n": {
    "ru": {
      "answer": "Решение",
      "status": "Статус"
    },
    "en": {
      "answer": "Answer",
      "status": "Status"
    }
  },
  "definition": {
    "components": [
      {
        "label": {
          "ru": "Решения",
          "en": "Answered questions"
        },
        "key": "answers",
        "source": {
          "type": "custom",
          "custom": {
            "columns": [
              {
                "name": "answer",
                "formatter": "",
                "setAttributesManually": true,
                "title": "answer",
                "type": "text",
                "multiple": false
              },
              {
                "name": "_status",
                "formatter": "",
                "setAttributesManually": true,
                "title": "status",
                "type": "text",
                "multiple": false
              }
            ],
            "record": null,
            "attribute": null
          }
        },
        "refreshOn": [
          "answeredQuestionRefs"
        ],
        "calculateValue": "value = _.get(data, 'answeredQuestionRefs.answers', []);\n",
        "optionalWhenDisabled": false,
        "customConditional": "console.log(data);",
        "type": "tableForm",
        "input": true,
        "addAnother": "ecos.forms.btn.add-another"
      },
      {
        "label": {
          "ru": "Submit"
        },
        "key": "submit2",
        "action": "custom",
        "state": "",
        "refreshOn": [],
        "optionalWhenDisabled": false,
        "type": "button",
        "input": true,
        "addAnother": "ecos.forms.btn.add-another",
        "showValidations": false,
        "custom": "const tableFormComponent = utils.getComponent(form.components, 'tableFormComponentKey');\r\nif (!tableFormComponent) {\r\n    return;\r\n}\r\n\r\nconst selectedRows = tableFormComponent.getSelectedRows();\r\n\r\n// some actions with selectedRows"
      },
      {
        "label": {
          "ru": "Протокол",
          "en": "Protocol"
        },
        "key": "_ECM_childProtocol",
        "refreshOn": [],
        "optionalWhenDisabled": false,
        "type": "hidden",
        "input": true,
        "addAnother": "ecos.forms.btn.add-another"
      },
      {
        "label": "answeredQuestionRefs",
        "source": {
          "type": "record",
          "record": {
            "id": "{{data._ECM_childProtocol}}",
            "attributes": {
              "answers": "answeredQuestions[]?assoc"
            }
          },
          "forceLoad": false
        },
        "update": {
          "type": "once"
        },
        "refreshOn": [
          {
            "label": "_ECM_childProtocol",
            "value": "_ECM_childProtocol"
          }
        ],
        "key": "answeredQuestionRefs",
        "type": "asyncData",
        "input": true,
        "addAnother": "ecos.forms.btn.add-another"
      },
      {
        "label": "statuses",
        "source": {
          "type": "recordsScript",
          "recordsScript": {
            "script": "value = _.get(data, 'answeredQuestionRefs.answers');",
            "attributes": {
              "status": "_status?str"
            }
          },
          "forceLoad": false
        },
        "update": {
          "type": "once"
        },
        "refreshOn": [
          {
            "label": "answeredQuestionRefs",
            "value": "answeredQuestionRefs"
          }
        ],
        "key": "statuses",
        "type": "asyncData",
        "input": true,
        "addAnother": "ecos.forms.btn.add-another"
      },
      {
        "key": "appropriateStatus",
        "refreshOn": [
          "statuses"
        ],
        "calculateValue": "const statuses = _.get(data, 'statuses', []);\nconst appropriateStatuses = ['undone', 'checked'];\n\nvar result = true;\nif (_.isArray(statuses)) {\n  statuses.forEach(obj => {\n    if (!appropriateStatuses.includes(obj.status)) {\n      result = false;\n    }\n  });\n} else {\n  result = false;\n}\n\nvalue = result;\n\n\n\n",
        "optionalWhenDisabled": false,
        "type": "hidden",
        "input": true,
        "addAnother": "ecos.forms.btn.add-another"
      },
      {
        "label": {
          "ru": "Начать исполнение",
          "en": "Start performing"
        },
        "key": "outcome_start_performing",
        "disabled": true,
        "state": "",
        "theme": "primary",
        "disableOnInvalid": true,
        "refreshOn": [],
        "optionalWhenDisabled": false,
        "logic": [
          {
            "name": "unlockIfAppropriateStatuses",
            "trigger": {
              "type": "simple",
              "simple": {
                "show": true,
                "when": "appropriateStatus",
                "eq": "true"
              }
            },
            "actions": [
              {
                "name": "unlock",
                "type": "property",
                "property": {
                  "label": "Disabled",
                  "value": "disabled",
                  "type": "boolean"
                },
                "state": "false"
              }
            ]
          }
        ],
        "type": "button",
        "input": true
      }
    ]
  },
  "attributes": {}
}
